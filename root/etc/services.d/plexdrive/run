#!/usr/bin/with-contenv bash

version=$(/usr/local/bin/plexdrive --version)
echo "Starting Plexdrive v${version}"

if [ -r "${configSubDir}/config.json" ] || [ -r "${configSubDir}/token.json" ]; then
  exec s6-setuidgid plex \
      /bin/sh -c \
        "/usr/local/bin/plexdrive mount -v 2 -c ${HOME}/${PLEXDRIVE_CONFIG_DIR} --cache-file=${HOME}/${PLEXDRIVE_CONFIG_DIR}/cache.bolt ${EXTRA_PARAMS} -o allow_other ${PLEXDRIVE_MOUNT_POINT}"
else
  echo "ERROR: Plexdrive config files (config.json and token.json) not found, enter on container terminal and execute a first mount commmand manually."
  sleep 30
fi
